{"version":3,"file":"instruction.js","sourceRoot":"","sources":["../../../../src/programs/stakePool/instruction.ts"],"names":[],"mappings":"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","sourcesContent":["import { findAta } from \"@cardinal/common\";\nimport {\n  CRANK_KEY,\n  getRemainingAccountsForKind,\n  TOKEN_MANAGER_ADDRESS,\n  TokenManagerKind,\n  TokenManagerState,\n} from \"@cardinal/token-manager/dist/cjs/programs/tokenManager\";\nimport {\n  findMintCounterId,\n  findTokenManagerAddress,\n} from \"@cardinal/token-manager/dist/cjs/programs/tokenManager/pda\";\nimport { MetadataProgram } from \"@metaplex-foundation/mpl-token-metadata\";\nimport type { BN } from \"@project-serum/anchor\";\nimport { AnchorProvider, Program } from \"@project-serum/anchor\";\nimport type { Wallet } from \"@saberhq/solana-contrib\";\nimport {\n  ASSOCIATED_TOKEN_PROGRAM_ID,\n  TOKEN_PROGRAM_ID,\n} from \"@solana/spl-token\";\nimport type {\n  AccountMeta,\n  Connection,\n  PublicKey,\n  TransactionInstruction,\n} from \"@solana/web3.js\";\nimport { SystemProgram, SYSVAR_RENT_PUBKEY } from \"@solana/web3.js\";\n\nimport type { STAKE_POOL_PROGRAM } from \".\";\nimport { STAKE_POOL_ADDRESS, STAKE_POOL_IDL } from \".\";\nimport { ReceiptType } from \"./constants\";\nimport { findStakeAuthorizationId } from \"./pda\";\nimport { remainingAccountsForInitStakeEntry } from \"./utils\";\n\nexport const initPoolIdentifier = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    identifierId: PublicKey;\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.initIdentifier({\n    accounts: {\n      identifier: params.identifierId,\n      payer: wallet.publicKey,\n      systemProgram: SystemProgram.programId,\n    },\n  });\n};\n\nexport const initStakePool = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    identifierId: PublicKey;\n    stakePoolId: PublicKey;\n    requiresCreators: PublicKey[];\n    requiresCollections: PublicKey[];\n    requiresAuthorization?: boolean;\n    overlayText: string;\n    imageUri: string;\n    authority: PublicKey;\n    resetOnStake: boolean;\n    cooldownSeconds: number | null;\n    minStakeSeconds: number | null;\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.initPool(\n    {\n      overlayText: params.overlayText,\n      imageUri: params.imageUri,\n      requiresCollections: params.requiresCollections,\n      requiresCreators: params.requiresCreators,\n      requiresAuthorization: params.requiresAuthorization ?? false,\n      authority: params.authority,\n      resetOnStake: params.resetOnStake,\n      cooldownSeconds: params.cooldownSeconds,\n      minStakeSeconds: params.minStakeSeconds,\n    },\n    {\n      accounts: {\n        stakePool: params.stakePoolId,\n        identifier: params.identifierId,\n        payer: wallet.publicKey,\n        systemProgram: SystemProgram.programId,\n      },\n    }\n  );\n};\n\nexport const authorizeStakeEntry = async (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    originalMintId: PublicKey;\n  }\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n\n  const [stakeAuthorizationId] = await findStakeAuthorizationId(\n    params.stakePoolId,\n    params.originalMintId\n  );\n  return stakePoolProgram.instruction.authorizeMint(params.originalMintId, {\n    accounts: {\n      stakePool: params.stakePoolId,\n      stakeAuthorizationRecord: stakeAuthorizationId,\n      payer: wallet.publicKey,\n      systemProgram: SystemProgram.programId,\n    },\n  });\n};\n\nexport const initStakeEntry = async (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    stakeEntryId: PublicKey;\n    originalMintId: PublicKey;\n    originalMintMetadatId: PublicKey;\n  }\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  const remainingAccounts = await remainingAccountsForInitStakeEntry(\n    params.stakePoolId,\n    params.originalMintId\n  );\n  return stakePoolProgram.instruction.initEntry(wallet.publicKey, {\n    accounts: {\n      stakeEntry: params.stakeEntryId,\n      stakePool: params.stakePoolId,\n      originalMint: params.originalMintId,\n      originalMintMetadata: params.originalMintMetadatId,\n      payer: wallet.publicKey,\n      systemProgram: SystemProgram.programId,\n    },\n    remainingAccounts,\n  });\n};\n\nexport const initStakeMint = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    stakeEntryId: PublicKey;\n    originalMintId: PublicKey;\n    originalMintMetadatId: PublicKey;\n    stakeEntryStakeMintTokenAccountId: PublicKey;\n    stakeMintMetadataId: PublicKey;\n    stakeMintId: PublicKey;\n    mintManagerId: PublicKey;\n    name: string;\n    symbol: string;\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n\n  return stakePoolProgram.instruction.initStakeMint(\n    { name: params.name, symbol: params.symbol },\n    {\n      accounts: {\n        stakeEntry: params.stakeEntryId,\n        stakePool: params.stakePoolId,\n        originalMint: params.originalMintId,\n        originalMintMetadata: params.originalMintMetadatId,\n        stakeMint: params.stakeMintId,\n        stakeMintMetadata: params.stakeMintMetadataId,\n        stakeEntryStakeMintTokenAccount:\n          params.stakeEntryStakeMintTokenAccountId,\n        mintManager: params.mintManagerId,\n        payer: wallet.publicKey,\n        rent: SYSVAR_RENT_PUBKEY,\n        tokenProgram: TOKEN_PROGRAM_ID,\n        tokenManagerProgram: TOKEN_MANAGER_ADDRESS,\n        associatedToken: ASSOCIATED_TOKEN_PROGRAM_ID,\n        tokenMetadataProgram: MetadataProgram.PUBKEY,\n        systemProgram: SystemProgram.programId,\n      },\n    }\n  );\n};\n\nexport const claimReceiptMint = async (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakeEntryId: PublicKey;\n    tokenManagerReceiptMintTokenAccountId: PublicKey;\n    originalMintId: PublicKey;\n    receiptMintId: PublicKey;\n    receiptType: ReceiptType;\n  }\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n\n  const [\n    [tokenManagerId],\n    [mintCounterId],\n    stakeEntryReceiptMintTokenAccountId,\n    userReceiptMintTokenAccountId,\n    remainingAccounts,\n  ] = await Promise.all([\n    findTokenManagerAddress(params.receiptMintId),\n    findMintCounterId(params.receiptMintId),\n    findAta(params.receiptMintId, params.stakeEntryId, true),\n    findAta(params.receiptMintId, wallet.publicKey, true),\n    getRemainingAccountsForKind(\n      params.receiptMintId,\n      params.receiptType === ReceiptType.Original\n        ? TokenManagerKind.Edition\n        : TokenManagerKind.Managed\n    ),\n  ]);\n\n  return stakePoolProgram.instruction.claimReceiptMint({\n    accounts: {\n      stakeEntry: params.stakeEntryId,\n      originalMint: params.originalMintId,\n      receiptMint: params.receiptMintId,\n      stakeEntryReceiptMintTokenAccount: stakeEntryReceiptMintTokenAccountId,\n      user: wallet.publicKey,\n      userReceiptMintTokenAccount: userReceiptMintTokenAccountId,\n      mintCounter: mintCounterId,\n      tokenManager: tokenManagerId,\n      tokenManagerReceiptMintTokenAccount:\n        params.tokenManagerReceiptMintTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      tokenManagerProgram: TOKEN_MANAGER_ADDRESS,\n      systemProgram: SystemProgram.programId,\n      associatedTokenProgram: ASSOCIATED_TOKEN_PROGRAM_ID,\n      rent: SYSVAR_RENT_PUBKEY,\n    },\n    remainingAccounts,\n  });\n};\n\nexport const stake = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    originalMint: PublicKey;\n    stakeEntryId: PublicKey;\n    stakePoolId: PublicKey;\n    stakeEntryOriginalMintTokenAccountId: PublicKey;\n    userOriginalMintTokenAccountId: PublicKey;\n    amount: BN;\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n\n  return stakePoolProgram.instruction.stake(params.amount, {\n    accounts: {\n      stakeEntry: params.stakeEntryId,\n      stakePool: params.stakePoolId,\n      stakeEntryOriginalMintTokenAccount:\n        params.stakeEntryOriginalMintTokenAccountId,\n      originalMint: params.originalMint,\n      user: wallet.publicKey,\n      userOriginalMintTokenAccount: params.userOriginalMintTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n  });\n};\n\nexport const unstake = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    stakeEntryId: PublicKey;\n    originalMintId: PublicKey;\n    stakeEntryOriginalMintTokenAccount: PublicKey;\n    userOriginalMintTokenAccount: PublicKey;\n    user: PublicKey;\n    remainingAccounts: AccountMeta[];\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.unstake({\n    accounts: {\n      stakePool: params.stakePoolId,\n      stakeEntry: params.stakeEntryId,\n      originalMint: params.originalMintId,\n      stakeEntryOriginalMintTokenAccount:\n        params.stakeEntryOriginalMintTokenAccount,\n      user: params.user,\n      userOriginalMintTokenAccount: params.userOriginalMintTokenAccount,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n    remainingAccounts: params.remainingAccounts,\n  });\n};\n\nexport const updateStakePool = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    requiresCreators?: PublicKey[];\n    requiresCollections?: PublicKey[];\n    requiresAuthorization?: boolean;\n    overlayText?: string;\n    imageUri?: string;\n    authority?: PublicKey;\n    resetOnStake?: boolean;\n    cooldownSeconds?: number;\n    minStakeSeconds?: number;\n  }\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.updatePool(\n    {\n      overlayText: params.overlayText || \"RENTED\",\n      imageUri: params.imageUri || \"\",\n      requiresCollections: params.requiresCollections || null,\n      requiresCreators: params.requiresCreators || null,\n      requiresAuthorization: params.requiresAuthorization || false,\n      authority: params.authority || null,\n      resetOnStake: params.resetOnStake || false,\n      cooldownSeconds: params.cooldownSeconds || null,\n      minStakeSeconds: params.minStakeSeconds || null,\n    },\n    {\n      accounts: {\n        stakePool: params.stakePoolId,\n        payer: wallet.publicKey,\n      },\n    }\n  );\n};\n\nexport const updateTotalStakeSeconds = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakEntryId: PublicKey;\n    lastStaker: PublicKey;\n  }\n) => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.updateTotalStakeSeconds({\n    accounts: {\n      stakeEntry: params.stakEntryId,\n      lastStaker: params.lastStaker,\n    },\n  });\n};\n\nexport const returnReceiptMint = async (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakeEntry: PublicKey;\n    receiptMint: PublicKey;\n    tokenManagerKind: TokenManagerKind;\n    tokenManagerState: TokenManagerState;\n    returnAccounts: AccountMeta[];\n  }\n) => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n\n  const [tokenManagerId] = await findTokenManagerAddress(params.receiptMint);\n  const tokenManagerTokenAccountId = await findAta(\n    params.receiptMint,\n    (\n      await findTokenManagerAddress(params.receiptMint)\n    )[0],\n    true\n  );\n\n  const userReceiptMintTokenAccount = await findAta(\n    params.receiptMint,\n    wallet.publicKey,\n    true\n  );\n\n  const transferAccounts = await getRemainingAccountsForKind(\n    params.receiptMint,\n    params.tokenManagerKind\n  );\n\n  return stakePoolProgram.instruction.returnReceiptMint({\n    accounts: {\n      stakeEntry: params.stakeEntry,\n      receiptMint: params.receiptMint,\n      tokenManager: tokenManagerId,\n      tokenManagerTokenAccount: tokenManagerTokenAccountId,\n      userReceiptMintTokenAccount: userReceiptMintTokenAccount,\n      user: wallet.publicKey,\n      collector: CRANK_KEY,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      tokenManagerProgram: TOKEN_MANAGER_ADDRESS,\n      rent: SYSVAR_RENT_PUBKEY,\n    },\n    remainingAccounts: [\n      ...(params.tokenManagerState === TokenManagerState.Claimed\n        ? transferAccounts\n        : []),\n      ...params.returnAccounts,\n    ],\n  });\n};\n\nexport const closeStakePool = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    authority: PublicKey;\n  }\n) => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.closeStakePool({\n    accounts: {\n      stakePool: params.stakePoolId,\n      authority: params.authority,\n    },\n  });\n};\n\nexport const closeStakeEntry = (\n  connection: Connection,\n  wallet: Wallet,\n  params: {\n    stakePoolId: PublicKey;\n    stakeEntryId: PublicKey;\n    authority: PublicKey;\n  }\n) => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const stakePoolProgram = new Program<STAKE_POOL_PROGRAM>(\n    STAKE_POOL_IDL,\n    STAKE_POOL_ADDRESS,\n    provider\n  );\n  return stakePoolProgram.instruction.closeStakeEntry({\n    accounts: {\n      stakePool: params.stakePoolId,\n      stakeEntry: params.stakeEntryId,\n      authority: params.authority,\n    },\n  });\n};\n"]}