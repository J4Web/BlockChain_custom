"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useAddressName = void 0;
const tslib_1 = require("tslib");
const namespaces_1 = require("@cardinal/namespaces");
const react_1 = require("react");
const WalletIdentityProvider_1 = require("../providers/WalletIdentityProvider");
const constants_1 = require("../utils/constants");
const useAddressName = (connection, address, namespaceName = constants_1.TWITTER_NAMESPACE_NAME) => {
    const { handle } = (0, WalletIdentityProvider_1.useWalletIdentity)();
    const [displayName, setDisplayName] = (0, react_1.useState)();
    const [loadingName, setLoadingName] = (0, react_1.useState)(true);
    const refreshName = () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
        try {
            setLoadingName(true);
            if (address) {
                const [namespaceId] = yield (0, namespaces_1.findNamespaceId)(namespaceName);
                const n = yield (0, namespaces_1.tryGetName)(connection, address, namespaceId);
                setDisplayName(n);
            }
        }
        finally {
            setLoadingName(false);
        }
    });
    (0, react_1.useMemo)(() => {
        void refreshName();
    }, [connection, address === null || address === void 0 ? void 0 : address.toString(), namespaceName, handle]);
    return { displayName, loadingName, refreshName };
};
exports.useAddressName = useAddressName;
//# sourceMappingURL=useAddressName.js.map